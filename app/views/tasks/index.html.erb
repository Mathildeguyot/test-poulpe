<% if user_signed_in? %>
  <div class="overlay invisible"></div>
  <div class="d-flex justify-content-between align-items-center">
    <h1>Bienvenue sur ta to do !</h1>
    <%= link_to "", destroy_user_session_path, :class => "fas fa-sign-out-alt", method: :delete %>
  </div>
  <i class="fas fa-plus-circle" id="plus"></i>
  <div class="task-form invisible">
    <h3>Ajoute une tâche</h3>
    <%= simple_form_for @task, remote: true do |f| %>
      <%= f.input :title, as: :string, placeholder: "Ex : Décorer le sapin", label: false %>
      <div class="d-flex">
        <%= f.input :deadline, as: :date, html5: true, label: false, input_html: { id: "deadline-input" } %>
        <%= f.button :submit, 'Go !', input_html: { id: "new-task-button" }, class: 'btn-primary' %>
      </div>
    <% end %>
  </div>
  <div class="d-flex justify-content-between">
    <div class="done-tasks">
      <h2>Déjà fait !</h2>
      <% @done.each do |task| %>
        <div class="task-card">
          <div class="top-card">
            <div class="d-flex align-items-center justify-content-between">
              <div class="d-flex">
                <i class="fas fa-check-circle done"></i>
                <p id="task-<%= task.id %>" class="task-title"><%= task.title %></p>
              </div>
              <%= link_to "", task_path(task), :class => "far fa-trash-alt trash", method: :delete, remote: true, data: { confirm: "Êtes-vous sûrs de vouloir supprimer cette tâche ?" }  %>
            </div>
            <p class="deadline"><%= task.deadline %></p>
          </div>
          <% task.comments.each do |comment| %>
            <div class="d-flex comment">
              <p id="comment-<%= comment.id %>"><%= comment.content %></p>
              <%= link_to "", comment_path(comment), :class => "fas fa-times delete", method: :delete, remote: true, data: { confirm: "Êtes-vous sûrs de vouloir supprimer ce commentaire ?" }  %>
            </div>
          <% end %>
          <%= simple_form_for ([task, @comment]), remote: true do |f| %>
            <%= f.input :content, as: :string, placeholder: "Écris un commentaire...", label: false, input_html: { id: 'new_comment'}, wrapper_html: { class: 'new_comment'} %>
          <% end %>
        </div>
      <% end %>
    </div>


    <div class="undone-tasks">
      <h2>À faire</h2>
      <% @todo.each do |task| %>
        <div class="todo-card task-card">
          <div class="top-card">
            <div class="d-flex align-items-center justify-content-between">
              <div class="d-flex">
                <i class="fas far fa-circle todo"></i>
                <p id="task-<%= task.id %>" class="task-title"><%= task.title %></p>
              </div>
              <%= link_to "", task_path(task), :class => "far fa-trash-alt trash", method: :delete, remote: true, data: { confirm: "Êtes-vous sûrs de vouloir supprimer cette tâche ?" }  %>
            </div>
            <p class="deadline"><%= task.deadline %></p>
          </div>
          <% task.comments.each do |comment| %>
            <div class="d-flex comment">
              <p id="comment-<%= comment.id %>"><%= comment.content %></p>
              <%= link_to "", comment_path(comment), :class => "fas fa-times delete", method: :delete, remote: true, data: { confirm: "Êtes-vous sûrs de vouloir supprimer ce commentaire ?" }  %>
            </div>
          <% end %>
          <%= simple_form_for ([task, @comment]), remote: true do |f| %>
            <%= f.input :content, as: :string, placeholder: "Écris un commentaire...", label: false, input_html: { id: 'new_comment'}, wrapper_html: { class: 'new_comment'} %>
          <% end %>
        </div>
      <% end %>
    </div>


    <div class="urgent-tasks">
      <h2>Urgent</h2>
      <% @todo.each do |task| %>
        <div class="urgent-card task-card">
          <div class="top-card">
            <div class="d-flex align-items-center justify-content-between">
              <div class="d-flex">
                <i class="fas far fa-circle todo"></i>
                <p id="task-<%= task.id %>" class="task-title"><%= task.title %></p>
              </div>
              <%= link_to "", task_path(task), :class => "far fa-trash-alt trash", method: :delete, remote: true, data: { confirm: "Êtes-vous sûrs de vouloir supprimer cette tâche ?" }  %>
            </div>
            <p class="deadline"><%= task.deadline %></p>
          </div>
          <% task.comments.each do |comment| %>
            <div class="d-flex comment">
              <p id="comment-<%= comment.id %>"><%= comment.content %></p>
              <%= link_to "", comment_path(comment), :class => "fas fa-times delete", method: :delete, remote: true, data: { confirm: "Êtes-vous sûrs de vouloir supprimer ce commentaire ?" }  %>
            </div>
          <% end %>
          <%= simple_form_for ([task, @comment]), remote: true do |f| %>
            <%= f.input :content, as: :string, placeholder: "Écris un commentaire...", label: false, input_html: { id: 'new_comment'}, wrapper_html: { class: 'new_comment'} %>
          <% end %>
        </div>
      <% end %>
    </div>


  </div>

<% else %>
  <%= link_to "Login", new_user_session_path %>
<% end %>
